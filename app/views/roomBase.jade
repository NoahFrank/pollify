extends layout

block content
    h1 Welcome to #{roomName}
    p Please queue a song!

    if roomUsers.length > 0
        h2 Users in room:
            ul
                each user in roomUsers
                    li #{user}

    p 
        if isOwner
            Room Controls:
        else
            Vote Room Controls
        table
            thead
                tr
                    th Album Cover
                    th Song Name
                    th Album
                    th Artist
                    th Progress
            tbody
                tr
                    td
                        img(src='#{roomCurrentPlaybackState.item.album.images[0].url}', height=64, width=64)
                    td= roomCurrentPlaybackState.item.name
                    td= roomCurrentPlaybackState.item.album.name
                    td= roomCurrentPlaybackState.item.artists[0].name
                    td= roomCurrentPlaybackState.progress_ms/roomCurrentPlaybackState.item.duration_ms
        table
            thead
                tr
                    //- th Play
                    //- th Skip
            tbody
                tr
                    td
                        if isOwner
                            if roomCurrentPlaybackState.is_playing == true
                                form(id="play", method="POST", action="/#{roomName}/pause")
                                    //- TODO: csrf
                                    button(type="submit")
                                        ="pause"
                            else
                                form(id="play", method="POST", action="/#{roomName}/play")
                                    //- TODO: csrf
                                    button(type="submit")
                                        ="play"
                        else
                            "vote to play/pause"
                    td
                        if isOwner
                            "spotify next call"
                        else
                            "vote to skip"

    p
        form(name="spotifySearch", method="post", action="/#{roomName}/search")
            | Search for a Song:
            input(type="text", name="trackSearch")
            input(type="submit", value="Search")

    block roomContent
